#include "header.h"

void print_list( gpointer data , gpointer user_data)
{
	printf("%s\n", (char*)data);
}

GSList *  file_reader ( FILE * fp)
{
	char* line = NULL;
	line = malloc( 0 * sizeof(*line)); 
	GSList * list = NULL;
	
	while( fgets (line , 256 , fp ) != NULL )
	{
		line[strcspn(line , "\n")] = 0;
		list = g_slist_append( list , strdup( line ));
	}
	g_slist_foreach( list , print_list , NULL);
	return list;

}

void caller ( GSList * list , char * base , char* replace)
{
	int i=0;
	char * list_data;
	int size = g_slist_length( list);
	while( i <= size)
	{
		list_data = (char*)g_slist_nth_data(list , i);	
		handler( list_data , base , replace );
		i++;
	}	
}

void handler (char* list_data ,char * base , char* replace )
{
	FILE * fp =NULL;
	char  line[200] ;
	
	fp = fopen( list_data , "r");
	 
	if(fp ==NULL)
	{
		printf("FIle not opened");
	}
	//line = malloc( 0 * sizeof(*line)); 
	while( fgets( line , 512 , fp )!= NULL)
	{
		printf("%s\n",line);
		char * result = NULL;	
		result  = search_replace( line , (char*)base , (char*)replace );
		write_to_file(result);

		
	}
	
	
}

void write_to_file( char * result )
{	
	//printf("%s\n",result);
	FILE* out = NULL;
	out = fopen( "test" , "ab"); 
		fprintf( out  ,"%s" , result); 
	fclose(out);
}



++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#include "header.h"

int main(int argc ,char* argv[])
{
	GSList * list = NULL;
	FILE *fp = NULL;
	fp = fopen("../files/config.txt" , "r");
	list = file_reader( fp );

	caller( list , argv[1] , argv[2] );
	return 0;
}


